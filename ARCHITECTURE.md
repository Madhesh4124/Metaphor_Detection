# ğŸ—ï¸ System Architecture

Visual guide to understanding how the Multilingual Metaphor Detection system works.

---

## ğŸ“Š High-Level Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USER                                 â”‚
â”‚                    (Web Browser)                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ HTTP Requests
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   FRONTEND (React)                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ Text Input / Speech Recording                     â”‚   â”‚
â”‚  â”‚  â€¢ Language Detection Display                        â”‚   â”‚
â”‚  â”‚  â€¢ Results Visualization                             â”‚   â”‚
â”‚  â”‚  â€¢ Error Handling                                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                    Port: 3000                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ REST API Calls
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  BACKEND (FastAPI)                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  API Endpoints:                                      â”‚   â”‚
â”‚  â”‚  â€¢ /predict    - Metaphor detection                 â”‚   â”‚
â”‚  â”‚  â€¢ /translate  - Translation                        â”‚   â”‚
â”‚  â”‚  â€¢ /speech     - Speech-to-text                     â”‚   â”‚
â”‚  â”‚  â€¢ /health     - Health check                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                    Port: 8000                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ Model Inference
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ML MODELS                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Hindi Model  â”‚  â”‚ Tamil Model  â”‚  â”‚Kannada Model â”‚     â”‚
â”‚  â”‚ XLM-RoBERTa  â”‚  â”‚ XLM-RoBERTa  â”‚  â”‚Kannada-BERT  â”‚     â”‚
â”‚  â”‚   270M       â”‚  â”‚   270M       â”‚  â”‚   110M       â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Request Flow

### 1. User Input Flow

```
User Types Text
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Text Input  â”‚
â”‚   Field     â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Submit    â”‚
â”‚   Button    â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend Validationâ”‚
â”‚  â€¢ Check not empty  â”‚
â”‚  â€¢ Trim whitespace  â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  API Request        â”‚
â”‚  POST /predict      â”‚
â”‚  { text: "..." }    â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
   Backend
```

### 2. Backend Processing Flow

```
API Request Received
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Language         â”‚
â”‚ Detection        â”‚
â”‚ â€¢ Unicode check  â”‚
â”‚ â€¢ Keyword match  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”œâ”€â”€â”€ Hindi â”€â”€â”€â”€â”
     â”œâ”€â”€â”€ Tamil â”€â”€â”€â”€â”¤
     â””â”€â”€â”€ Kannada â”€â”€â”¤
                    â”‚
                    â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Load Appropriate â”‚
         â”‚     Model        â”‚
         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   Tokenization   â”‚
         â”‚ â€¢ Convert to IDs â”‚
         â”‚ â€¢ Add padding    â”‚
         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Model Inference  â”‚
         â”‚ â€¢ Forward pass   â”‚
         â”‚ â€¢ Get logits     â”‚
         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   Softmax        â”‚
         â”‚ â€¢ Calculate prob â”‚
         â”‚ â€¢ Get confidence â”‚
         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Classification   â”‚
         â”‚ â€¢ Metaphor (1)   â”‚
         â”‚ â€¢ Normal (0)     â”‚
         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  JSON Response   â”‚
         â”‚ {                â”‚
         â”‚   language: "hi" â”‚
         â”‚   label: "..."   â”‚
         â”‚   confidence: #  â”‚
         â”‚ }                â”‚
         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
         Frontend Display
```

### 3. Translation Flow (If Metaphor Detected)

```
Metaphor Detected
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend checks â”‚
â”‚ label == "meta" â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /translate â”‚
â”‚ {               â”‚
â”‚   text: "..."   â”‚
â”‚   source: "hi"  â”‚
â”‚ }               â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Backend         â”‚
â”‚ Translation     â”‚
â”‚ (IndicTrans2)   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Display English â”‚
â”‚ Translation     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§© Component Architecture

### Frontend Components

```
App.jsx (Main Component)
â”‚
â”œâ”€â”€ State Management
â”‚   â”œâ”€â”€ inputText
â”‚   â”œâ”€â”€ isRecording
â”‚   â”œâ”€â”€ isLoading
â”‚   â”œâ”€â”€ result
â”‚   â”œâ”€â”€ error
â”‚   â””â”€â”€ translation
â”‚
â”œâ”€â”€ Input Section
â”‚   â”œâ”€â”€ Text Area
â”‚   â”œâ”€â”€ Record Button
â”‚   â”œâ”€â”€ Analyze Button
â”‚   â””â”€â”€ Reset Button
â”‚
â”œâ”€â”€ Results Section
â”‚   â”œâ”€â”€ Language Display
â”‚   â”œâ”€â”€ Label Badge (Metaphor/Normal)
â”‚   â”œâ”€â”€ Confidence Score
â”‚   â””â”€â”€ Translation (if applicable)
â”‚
â””â”€â”€ Error Handling
    â””â”€â”€ Error Message Display
```

### Backend Structure

```
main.py (FastAPI App)
â”‚
â”œâ”€â”€ Configuration
â”‚   â”œâ”€â”€ CORS Middleware
â”‚   â”œâ”€â”€ Logging Setup
â”‚   â””â”€â”€ Model Paths
â”‚
â”œâ”€â”€ Global State
â”‚   â”œâ”€â”€ models = {}
â”‚   â””â”€â”€ tokenizers = {}
â”‚
â”œâ”€â”€ Utility Functions
â”‚   â”œâ”€â”€ detect_language()
â”‚   â””â”€â”€ load_models()
â”‚
â”œâ”€â”€ API Endpoints
â”‚   â”œâ”€â”€ GET  /health
â”‚   â”œâ”€â”€ POST /predict
â”‚   â”œâ”€â”€ POST /translate
â”‚   â””â”€â”€ POST /speech
â”‚
â””â”€â”€ Startup Event
    â””â”€â”€ Load all models
```

---

## ğŸ” Data Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Input   â”‚
â”‚  "à¤µà¤¹..." â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Language Detection  â”‚
â”‚ Result: "hindi"     â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Model Selection     â”‚
â”‚ Load: hindi_model   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tokenization        â”‚
â”‚ [101, 45, 67, ...]  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Model Forward Pass  â”‚
â”‚ Logits: [0.2, 0.8]  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Softmax             â”‚
â”‚ Probs: [0.1, 0.9]   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Classification      â”‚
â”‚ Label: "metaphor"   â”‚
â”‚ Confidence: 0.9     â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ JSON Response       â”‚
â”‚ {                   â”‚
â”‚   language: "hindi" â”‚
â”‚   label: "metaphor" â”‚
â”‚   confidence: 0.9   â”‚
â”‚ }                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¨ UI State Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Initial   â”‚
â”‚   State     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User Types â”‚
â”‚    Text     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     No      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Text Empty?â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  Enable     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜              â”‚  Submit Btn â”‚
       â”‚ Yes                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Disable    â”‚
â”‚  Submit Btn â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

User Clicks Submit
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  isLoading  â”‚
â”‚  = true     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Disable    â”‚
â”‚  All Inputs â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  API Call   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â”€ Success â”€â”€â”€â”
       â”‚               â–¼
       â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚        â”‚  Display    â”‚
       â”‚        â”‚  Results    â”‚
       â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â””â”€â”€â”€ Error â”€â”€â”€â”€â”€â”
                       â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚  Display    â”‚
                â”‚  Error Msg  â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Model Loading Sequence

```
Application Startup
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ @app.on_event    â”‚
â”‚ ("startup")      â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ load_models()    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”œâ”€â”€â”€ For each language â”€â”€â”€â”
     â”‚                          â”‚
     â”‚                          â–¼
     â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                   â”‚ Check path   â”‚
     â”‚                   â”‚ exists       â”‚
     â”‚                   â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                      â”‚
     â”‚                      â–¼
     â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                   â”‚ Load         â”‚
     â”‚                   â”‚ Tokenizer    â”‚
     â”‚                   â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                      â”‚
     â”‚                      â–¼
     â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                   â”‚ Load Model   â”‚
     â”‚                   â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                      â”‚
     â”‚                      â–¼
     â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                   â”‚ Set to eval  â”‚
     â”‚                   â”‚ mode         â”‚
     â”‚                   â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                      â”‚
     â”‚                      â–¼
     â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                   â”‚ Store in     â”‚
     â”‚                   â”‚ global dict  â”‚
     â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ All Models Ready â”‚
â”‚ Server Running   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸŒ Network Communication

```
Frontend (Port 3000)          Backend (Port 8000)
       â”‚                             â”‚
       â”‚  HTTP POST /predict         â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
       â”‚  Content-Type: JSON         â”‚
       â”‚  { text: "..." }            â”‚
       â”‚                             â”‚
       â”‚                             â”œâ”€ Process
       â”‚                             â”œâ”€ Detect Language
       â”‚                             â”œâ”€ Run Model
       â”‚                             â””â”€ Generate Response
       â”‚                             â”‚
       â”‚  HTTP 200 OK                â”‚
       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚  Content-Type: JSON         â”‚
       â”‚  {                          â”‚
       â”‚    language: "hindi",       â”‚
       â”‚    label: "metaphor",       â”‚
       â”‚    confidence: 0.92         â”‚
       â”‚  }                          â”‚
       â”‚                             â”‚
       â”‚  HTTP POST /translate       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
       â”‚  { text: "...",             â”‚
       â”‚    source_language: "hi" }  â”‚
       â”‚                             â”‚
       â”‚  HTTP 200 OK                â”‚
       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚  {                          â”‚
       â”‚    translated_text: "..."   â”‚
       â”‚  }                          â”‚
       â”‚                             â”‚
```

---

## ğŸ“¦ File Structure with Responsibilities

```
project_root/
â”‚
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ main.py
â”‚   â”‚   â”œâ”€â”€ FastAPI app initialization
â”‚   â”‚   â”œâ”€â”€ CORS configuration
â”‚   â”‚   â”œâ”€â”€ Model loading logic
â”‚   â”‚   â”œâ”€â”€ Language detection
â”‚   â”‚   â”œâ”€â”€ API endpoints
â”‚   â”‚   â””â”€â”€ Error handling
â”‚   â”‚
â”‚   â””â”€â”€ test_api.py
â”‚       â””â”€â”€ Automated API testing
â”‚
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ App.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Main component
â”‚   â”‚   â”‚   â”œâ”€â”€ State management
â”‚   â”‚   â”‚   â”œâ”€â”€ API communication
â”‚   â”‚   â”‚   â”œâ”€â”€ Event handlers
â”‚   â”‚   â”‚   â””â”€â”€ UI rendering
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ App.css
â”‚   â”‚   â”‚   â”œâ”€â”€ Component styling
â”‚   â”‚   â”‚   â”œâ”€â”€ Responsive design
â”‚   â”‚   â”‚   â”œâ”€â”€ Animations
â”‚   â”‚   â”‚   â””â”€â”€ Color schemes
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ main.jsx
â”‚   â”‚   â”‚   â””â”€â”€ React entry point
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ index.css
â”‚   â”‚       â””â”€â”€ Global styles
â”‚   â”‚
â”‚   â”œâ”€â”€ index.html
â”‚   â”‚   â””â”€â”€ HTML template
â”‚   â”‚
â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â””â”€â”€ Dependencies
â”‚   â”‚
â”‚   â””â”€â”€ vite.config.js
â”‚       â””â”€â”€ Build configuration
â”‚
â””â”€â”€ models/
    â”œâ”€â”€ hindi_model/
    â”‚   â”œâ”€â”€ config.json
    â”‚   â”œâ”€â”€ tokenizer files
    â”‚   â””â”€â”€ model weights
    â”‚
    â”œâ”€â”€ tamil_model/
    â”‚   â””â”€â”€ (same structure)
    â”‚
    â””â”€â”€ kannada_model/
        â””â”€â”€ (same structure)
```

---

## ğŸ” Language Detection Logic

```
Input Text
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Check Unicode Range â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”œâ”€â”€â”€ U+0900-097F â”€â”€â–¶ Hindi (Devanagari)
     â”‚
     â”œâ”€â”€â”€ U+0B80-0BFF â”€â”€â–¶ Tamil
     â”‚
     â”œâ”€â”€â”€ U+0C80-0CFF â”€â”€â–¶ Kannada
     â”‚
     â””â”€â”€â”€ No Match â”€â”€â”€â”€â”€â”
                        â”‚
                        â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Keyword Matchingâ”‚
              â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â”œâ”€â”€â”€ Hindi keywords found â”€â”€â–¶ Hindi
                   â”œâ”€â”€â”€ Tamil keywords found â”€â”€â–¶ Tamil
                   â”œâ”€â”€â”€ Kannada keywords found â”€â–¶ Kannada
                   â”‚
                   â””â”€â”€â”€ No Match â”€â”€â–¶ Error: Unsupported Language
```

---

## ğŸ¯ Model Inference Pipeline

```
Input: "à¤µà¤¹ à¤†à¤¸à¤®à¤¾à¤¨ à¤›à¥‚ à¤°à¤¹à¤¾ à¤¹à¥ˆ"
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tokenizer            â”‚
â”‚ â€¢ Split into tokens  â”‚
â”‚ â€¢ Convert to IDs     â”‚
â”‚ â€¢ Add special tokens â”‚
â”‚   [CLS] ... [SEP]    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ input_ids: [101, 45, 67, 89, 102]
     â”‚ attention_mask: [1, 1, 1, 1, 1]
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Model (XLM-RoBERTa)  â”‚
â”‚ â€¢ Embedding layer    â”‚
â”‚ â€¢ 12 Transformer     â”‚
â”‚   layers             â”‚
â”‚ â€¢ Classification     â”‚
â”‚   head               â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ logits: [0.2, 0.8]
     â”‚         [normal, metaphor]
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Softmax              â”‚
â”‚ exp(x) / sum(exp(x)) â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ probabilities: [0.12, 0.88]
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ArgMax               â”‚
â”‚ Get highest prob     â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ predicted_class: 1 (metaphor)
     â”‚ confidence: 0.88
     â”‚
     â–¼
Output: {
  label: "metaphor",
  confidence: 0.88
}
```

---

## ğŸ”„ Error Handling Flow

```
Request Received
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Try Block   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â”€ Success â”€â”€â–¶ Return 200 + Data
       â”‚
       â””â”€â”€â”€ Exception â”€â”
                       â”‚
                       â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Exception Type?  â”‚
            â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â”œâ”€â”€â”€ HTTPException â”€â”€â–¶ Return as-is
                 â”‚
                 â”œâ”€â”€â”€ ValueError â”€â”€â”€â”€â”€â–¶ Return 400 + Message
                 â”‚
                 â”œâ”€â”€â”€ FileNotFound â”€â”€â”€â–¶ Return 500 + "Model not found"
                 â”‚
                 â””â”€â”€â”€ Other â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ Return 500 + Generic message
```

---

## ğŸ’¾ State Management (Frontend)

```
App Component State
â”‚
â”œâ”€â”€ inputText: string
â”‚   â””â”€â”€ User's input text
â”‚
â”œâ”€â”€ isRecording: boolean
â”‚   â””â”€â”€ Microphone recording status
â”‚
â”œâ”€â”€ isLoading: boolean
â”‚   â””â”€â”€ API request in progress
â”‚
â”œâ”€â”€ result: object | null
â”‚   â”œâ”€â”€ language: string
â”‚   â”œâ”€â”€ label: string
â”‚   â”œâ”€â”€ confidence: number
â”‚   â””â”€â”€ text: string
â”‚
â”œâ”€â”€ error: string
â”‚   â””â”€â”€ Error message to display
â”‚
â””â”€â”€ translation: string
    â””â”€â”€ English translation (if metaphor)
```

---

## ğŸš€ Performance Optimization

```
Optimization Strategy
â”‚
â”œâ”€â”€ Backend
â”‚   â”œâ”€â”€ Load models once at startup
â”‚   â”œâ”€â”€ Keep models in memory
â”‚   â”œâ”€â”€ Use eval() mode (no gradients)
â”‚   â””â”€â”€ Process single requests
â”‚
â””â”€â”€ Frontend
    â”œâ”€â”€ Debounce input validation
    â”œâ”€â”€ Lazy load components
    â”œâ”€â”€ Minimize re-renders
    â””â”€â”€ Cache API responses (optional)
```

---

## ğŸ” Security Considerations

```
Security Measures
â”‚
â”œâ”€â”€ Backend
â”‚   â”œâ”€â”€ CORS configuration
â”‚   â”œâ”€â”€ Input validation
â”‚   â”œâ”€â”€ Rate limiting (to implement)
â”‚   â””â”€â”€ Error message sanitization
â”‚
â””â”€â”€ Frontend
    â”œâ”€â”€ XSS prevention (React auto-escapes)
    â”œâ”€â”€ HTTPS for microphone access
    â””â”€â”€ Input sanitization
```

---

This architecture document provides a visual understanding of how all components work together. Use it as a reference when explaining your project!

